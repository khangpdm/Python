<!DOCTYPE html>
{% load static %}
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch·∫•m Tr·∫Øc Nghi·ªám</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
    <header id="header">
        <h2>H·ªá th·ªëng nh·∫≠n di·ªán b√†i thi tr·∫Øc nghi·ªám</h2>
<ul>
            {% if username %}
                <li id="loginItem">
                    <a href="{% url 'logout' %}">ƒêƒÉng xu·∫•t ({{username}})</a>
                </li>
                <li>
                    <a href="#" onclick="showGuidanceModal(event)">H∆∞·ªõng d·∫´n</a>
                </li>
            {% else %}
                <li id="loginItem">
                    <a href="#" onclick="showLoginForm(event)">ƒêƒÉng nh·∫≠p</a>
                </li>
                <li>
                    <a href="#" onclick="showGuidanceModal(event)">H∆∞·ªõng d·∫´n</a>
                </li>
            {% endif %}
        </ul> 
    </header>

    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    {% if role == 'teacher' %}
        <section id="teacherSection">
            <h2>PH·∫¶N ƒêI·ªÄU KHI·ªÇN C·ª¶A GI√ÅO VI√äN</h2>
            <ul>
                <li><a href="{% url 'danh_sach_de_thi' %}"><button>Qu·∫£n l√Ω ƒë·ªÅ thi</button></a></li>
                <li><a href="{% url 'cau_hoi_list' %}"><button>Qu·∫£n l√Ω c√¢u h·ªèi</button></a></li>
                <li><a href="{% url 'xem_ket_qua' %}"><button>Xem k·∫øt qu·∫£ h·ªçc sinh</button></a></li>
                <li><a href="{% url 'them_hoc_sinh' %}"><button>Th√™m h·ªçc sinh</button></a></li>
            </ul>
        </section>

    {% elif role == 'student' %}
        <section id="studentSection">
            <h2 class="section-title">TH√îNG TIN C·ª¶A H·ªåC SINH</h2>
            <ul class="info-list">
                <li>
                    <button id="submitExamBtn" onclick="submitExam()">N·ªôp b√†i thi</button>
                    <div id="uploadSection" style="display: none; margin-top: 10px;">
                        <form id="uploadForm" method="POST" enctype="multipart/form-data" action="{% url 'upload_exam' %}">
                            {% csrf_token %}
                            <label for="selected_exam">Ch·ªçn ƒë·ªÅ thi:</label>
                            <select id="selected_exam" name="selected_exam" required>
                                <option value="" disabled selected>-- Vui l√≤ng ch·ªçn ƒë·ªÅ thi --</option>
                                {% if exams %}
                                    {% for exam in exams %}
                                        <option value="{{ exam.id }}">{{ exam.ten_de}}</option>
                                    {% endfor %}
                                {% else %}
                                    <option disabled>Kh√¥ng c√≥ ƒë·ªÅ thi n√†o ƒë∆∞·ª£c t√¨m th·∫•y</option>
                                {% endif %}
                            </select>
                            <input type="file" id="examImage" name="exam_file" accept="image/*" required>
                            <button type="submit" id="uploadExamBtn">T·∫£i l√™n b√†i thi</button>
                        </form>
                    </div>
                </li>
                <li><a href="{% url 'xem_ket_qua' %}"><button>Xem k·∫øt qu·∫£</button></a></li>
            </ul>
        </section>

    {% else %}
        <!-- Trang ch∆∞a ƒëƒÉng nh·∫≠p -->
        <div id="showForm">
            <section class="features">
                <h2>Ch·ª©c nƒÉng ch√≠nh</h2>
                <div class="feature-item">üìå Ch·∫•m ƒëi·ªÉm t·ª± ƒë·ªông</div>
                <div class="feature-item">üìä ƒê√°nh gi√° k·∫øt qu·∫£</div>
            </section>

            <section class="statistics">
                <h2>Th·ªëng k√™ n·ªïi b·∫≠t</h2>
                <div class="stat-item">‚úÖ 1000+ b√†i thi ƒë√£ ch·∫•m</div>
                <div class="stat-item">üéØ 95% ƒë·ªô ch√≠nh x√°c</div>
                <div class="stat-item">üë®‚Äçüè´ 500+ gi√°o vi√™n s·ª≠ d·ª•ng</div>
            </section>

            <section class="contact">
                <h2>Li√™n h·ªá</h2>
                <p><i class="fa fa-envelope"></i> <a href="mailto:domdom@gmail.com">domdom@gmail.com</a></p>
                <p><i class="fa fa-phone"></i> S·ªë ƒëi·ªán tho·∫°i: 0123456789</p>
            </section>
            
            <footer>
                <p>¬© 2025 Exam Grading System. All rights reserved.</p>
            </footer>

            <!-- Form ƒëƒÉng nh·∫≠p -->
            <form method="POST" action="{% url 'login' %}" id="loginForm">
                <div id="login">
                    {% csrf_token %}
                    <h2>ƒêƒÉng nh·∫≠p</h2>
                    <button type="button" class="close" onclick="closeLoginForm()">+</button>
                    <input type="text" name="username" placeholder="T√™n ƒëƒÉng nh·∫≠p" required autocomplete="username">
                    <input type="password" name="password" placeholder="M·∫≠t kh·∫©u" required autocomplete="current-password">
                    <button type="submit" class="btn-login">ƒêƒÉng nh·∫≠p</button>
                    <p class="text-center mt-2">
                        <a href="#" onclick="showRegisterForm(event)" class="text-blue-600 hover:underline">Th√™m t√†i kho·∫£n gi√°o vi√™n?</a>
                    </p>
                </div>
            </form>

            <!-- Form ƒëƒÉng k√Ω -->
            <form method="POST" action="{% url 'dang_ky_giao_vien' %}" id="registerForm" onsubmit="return confirmRegister()">
                <div id="register">
                    {% csrf_token %}
                    <h2>ƒêƒÉng k√Ω gi√°o vi√™n</h2>
                    <p style="color: #555;">L∆∞u √Ω: Form n√†y ch·ªâ d√†nh cho gi√°o vi√™n. H·ªçc sinh vui l√≤ng li√™n h·ªá gi√°o vi√™n ƒë·ªÉ ƒë∆∞·ª£c t·∫°o t√†i kho·∫£n.</p>
                    <button type="button" class="close" onclick="closeRegisterForm()">+</button>
                    <input type="text" name="ten_dang_nhap" placeholder="T√™n ƒëƒÉng nh·∫≠p" required>
                    <input type="password" name="mat_khau" placeholder="M·∫≠t kh·∫©u" required>
                    <input type="password" name="xac_nhan_mat_khau" placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u" required>
                    <button type="submit" class="btn-register">ƒêƒÉng k√Ω</button>
                    <p class="text-center mt-2">
                        <a href="#" onclick="showLoginForm(event)" class="text-blue-600 hover:underline">ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p</a>
                    </p>
                </div>
            </form>
        </div>
    {% endif %}
    <div id="guidanceModal" class="modal">
        <div class="modal-content">
            <h2>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
            <button type="button" class="close" onclick="closeGuidanceModal()">√ó</button>
            <h3>H∆∞·ªõng d·∫´n cho gi√°o vi√™n</h3>
            <ul>
                <li><strong>Qu·∫£n l√Ω ƒë·ªÅ thi</strong>: Truy c·∫≠p "Qu·∫£n l√Ω ƒë·ªÅ thi" ƒë·ªÉ t·∫°o ƒë·ªÅ thi m·ªõi, xem danh s√°ch ƒë·ªÅ thi, ho·∫∑c xu·∫•t PDF ƒë·ªÅ thi.</li>
                <li><strong>Qu·∫£n l√Ω c√¢u h·ªèi</strong>: V√†o "Qu·∫£n l√Ω c√¢u h·ªèi" ƒë·ªÉ th√™m, s·ª≠a, ho·∫∑c x√≥a c√¢u h·ªèi tr·∫Øc nghi·ªám.</li>
                <li><strong>Th√™m h·ªçc sinh</strong>: S·ª≠ d·ª•ng "Th√™m h·ªçc sinh" ƒë·ªÉ t·∫°o t√†i kho·∫£n cho h·ªçc sinh.</li>
                <li><strong>Xem k·∫øt qu·∫£</strong>: Truy c·∫≠p "Xem k·∫øt qu·∫£ h·ªçc sinh" ƒë·ªÉ xem danh s√°ch b√†i l√†m, ch·∫•m b√†i, ho·∫∑c xu·∫•t b√°o c√°o PDF.</li>
            </ul>
            <h3>H∆∞·ªõng d·∫´n cho h·ªçc sinh</h3>
            <ul>
                <li><strong>N·ªôp b√†i thi</strong>: Nh·∫•n "N·ªôp b√†i thi", ch·ªçn ƒë·ªÅ thi, v√† t·∫£i l√™n h√¨nh ·∫£nh b√†i thi c·ªßa b·∫°n.</li>
                <li><strong>Xem k·∫øt qu·∫£</strong>: V√†o "Xem k·∫øt qu·∫£" ƒë·ªÉ xem ƒëi·ªÉm, s·ªë c√¢u ƒë√∫ng/sai, v√† chi ti·∫øt b√†i l√†m.</li>
            </ul>
        </div>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="{% static 'js/script.js' %}"></script>
    <script>
        function showLoginForm(event) {
            event.preventDefault();
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const guidanceModal = document.getElementById('guidanceModal');
            if (loginForm && registerForm && guidanceModal) {
                loginForm.classList.add('show');
                registerForm.classList.remove('show');
                guidanceModal.classList.remove('show');
            } else {
                alert('L·ªói: Kh√¥ng th·ªÉ hi·ªÉn th·ªã form ƒëƒÉng nh·∫≠p. Vui l√≤ng th·ª≠ l·∫°i.');
            }
        }

        function closeLoginForm() {
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.classList.remove('show');
            }
        }

        function showRegisterForm(event) {
            event.preventDefault();
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const guidanceModal = document.getElementById('guidanceModal');
            if (loginForm && registerForm && guidanceModal) {
                loginForm.classList.remove('show');
                registerForm.classList.add('show');
                guidanceModal.classList.remove('show');
            } else {
                alert('L·ªói: Kh√¥ng th·ªÉ hi·ªÉn th·ªã form ƒëƒÉng k√Ω. Vui l√≤ng th·ª≠ l·∫°i.');
            }
        }

        function closeRegisterForm() {
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.classList.remove('show');
            }
        }

    function showGuidanceModal(event) {
        event.preventDefault();
        const guidanceModal = document.getElementById('guidanceModal');
        if (guidanceModal) {
            // ·∫®n c√°c form n·∫øu ch√∫ng t·ªìn t·∫°i
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            if (loginForm) loginForm.classList.remove('show');
            if (registerForm) registerForm.classList.remove('show');
            guidanceModal.classList.add('show');
        } else {
            alert('L·ªói: Kh√¥ng th·ªÉ hi·ªÉn th·ªã h∆∞·ªõng d·∫´n. Vui l√≤ng th·ª≠ l·∫°i.');
        }
    }
        // ƒê√≥ng modal h∆∞·ªõng d·∫´n
        function closeGuidanceModal() {
            const guidanceModal = document.getElementById('guidanceModal');
            if (guidanceModal) {
                guidanceModal.classList.remove('show');
            }
        }

        function submitExam() {
            const uploadSection = document.getElementById('uploadSection');
            if (uploadSection) {
                uploadSection.style.display = uploadSection.style.display === 'none' ? 'block' : 'none';
            }
        }

        function confirmRegister() {
            return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng k√Ω t√†i kho·∫£n gi√°o vi√™n n√†y?');
        }
    </script>
</html>